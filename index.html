<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Revisjon Platform</title>
    
    <!-- External Stylesheets -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/components.css">
</head>
<body>
    <header class="header">
        <h1>ü¶ñ AI Revisjon Platform</h1>
        <p>Moderne og profesjonell AI-transformasjon basert p√• Liam Ottleys rammeverk</p>
    </header>
    
    <nav class="nav">
        <button class="nav-button active" onclick="showSection('dashboard')">
            <span>üìã Dashboard</span>
        </button>
        <button class="nav-button" onclick="showSection('interviews')">
            <span>üé§ Intervjuer</span>
        </button>
        <button class="nav-button" onclick="showSection('process')">
            <span>üó∫Ô∏è Prosess Mapping</span>
        </button>
        <button class="nav-button" onclick="showSection('matrix')">
            <span>üìä Mulighetsmatrise</span>
        </button>
        <button class="nav-button" onclick="showSection('roi')">
            <span>üí∞ ROI Kalkulator</span>
        </button>
        <button class="nav-button" onclick="showSection('presentation')">
            <span>üìë Presentasjon</span>
        </button>
    </nav>
    
    <main class="main">
        <!-- Dashboard Section -->
        <section id="dashboard" class="content-section active">
            <h2>üìã Dashboard</h2>
            
            <div class="grid grid-2">
                <div class="card">
                    <h3>üè¢ Aktive AI Revisjoner</h3>
                    <div id="project-list">
                        <div class="project-item active" onclick="selectProject('demo')" data-project="demo">
                            <div class="project-header">
                                <strong>üöÄ Demo Bedrift AS</strong>
                                <span class="badge badge-info">P√•g√•ende</span>
                    </div>
                            <small>Startet: 15. januar 2024</small>
                        </div>
                    </div>
                    <button class="btn btn-success" onclick="openNewProjectPopup()">‚ûï Nytt Prosjekt</button>
                </div>
                
                <div class="card">
                    <h3>üìä Prosjektstatistikk</h3>
                    <div id="current-project-name" style="font-weight: bold; margin-bottom: 1rem;">Demo Bedrift AS</div>
                    <div class="grid grid-2" style="gap: 1rem;">
                        <div style="text-align: center;">
                            <div id="interviews-count" style="font-size: 2rem; color: #1976d2; font-weight: bold;">0</div>
                            <small>Intervjuer fullf√∏rt</small>
                        </div>
                        <div style="text-align: center;">
                            <div id="opportunities-count" style="font-size: 2rem; color: #4caf50; font-weight: bold;">0</div>
                            <small>AI-muligheter identifisert</small>
                        </div>
                    </div>
                    <div class="progress-bar" style="margin-top: 1rem;">
                        <div id="project-progress" class="progress-fill" style="width: 15%"></div>
                    </div>
                    <small id="progress-text">Prosjektfremgang: 15%</small>
                </div>
            </div>
            
            <div class="alert alert-info">
                <h4>üöÄ Kom i gang med AI-revisjonen</h4>
                <ol>
                    <li><strong>Intervjuer:</strong> Start med √• gjennomf√∏re stakeholder og sluttbruker intervjuer</li>
                    <li><strong>Prosess Mapping:</strong> Kartlegg bedriftens kjerneprosesser i Ops Canvas</li>
                    <li><strong>Mulighetsmatrise:</strong> Identifiser og prioriter AI-muligheter</li>
                    <li><strong>ROI Kalkulator:</strong> Beregn finansiell avkastning</li>
                    <li><strong>Presentasjon:</strong> Generer komplett klientrapport</li>
                </ol>
            </div>
            
            <div class="card">
                <h3>üìà Estimert verdi - <span id="project-name-roi">Demo Bedrift AS</span></h3>
                <div class="grid grid-4">
                    <div class="stat-card" style="background: linear-gradient(135deg, #4caf50, #388e3c);">
                        <div>Total ROI</div>
                        <div class="stat-value" id="dashboard-roi">-</div>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #ff9800, #f57c00);">
                        <div>Payback</div>
                        <div class="stat-value" id="dashboard-payback">-</div>
                        <small>m√•neder</small>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #2196f3, #1565c0);">
                        <div>√Örlig besparelse</div>
                        <div class="stat-value" id="dashboard-savings">-</div>
                        <small>NOK</small>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #9c27b0, #7b1fa2);">
                        <div>Investering</div>
                        <div class="stat-value" id="dashboard-investment">-</div>
                        <small>NOK</small>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Interviews Section -->
        <section id="interviews" class="content-section">
            <h2>üé§ Intervju Modul</h2>
            <p>Strukturerte intervjuer for √• forst√• bedriftens behov og identifisere AI-muligheter</p>
            
            <div class="grid grid-2">
                <div class="card">
                    <h3>üë• Stakeholder Intervjuer</h3>
                    <p><em>30.000-fots perspektiv fra ledelse</em></p>
                    
                    <h4>N√∏kkelsp√∏rsm√•l:</h4>
                    <ul style="margin: 1rem 0;">
                        <li>Kan du beskrive din rolle og teamets hovedansvar?</li>
                        <li>Hva er de viktigste m√•lene eller KPI-ene teamet ditt er ansvarlig for?</li>
                        <li>Hvor ser du de st√∏rste flaskehalser eller forsinkelser i arbeidsflyt?</li>
                        <li>Hva er de st√∏rste frustrasjonene med n√•v√¶rende teknologistakk?</li>
                        <li>Hvis du hadde en tryllestav, hvilket problem ville du l√∏st over natten?</li>
                    </ul>
                    
                    <button class="btn btn-primary" onclick="openInterviewPopup('stakeholder')">Nytt Stakeholder Intervju</button>
                </div>
                
                <div class="card">
                    <h3>üë§ Sluttbruker Intervjuer</h3>
                    <p><em>Operasjonelt perspektiv fra de som gj√∏r arbeidet</em></p>
                    
                    <h4>N√∏kkelsp√∏rsm√•l:</h4>
                    <ul style="margin: 1rem 0;">
                        <li>Kan du ta meg gjennom en typisk arbeidsdag eller -uke?</li>
                        <li>Hva er de mest manuelle og repetitive delene av jobben din?</li>
                        <li>Hvilken del av prosessen tar mest tid eller er mest frustrerende?</li>
                        <li>Hvis du hadde en assistent, hvilke oppgaver ville du gitt dem f√∏rst?</li>
                        <li>Er det dobbel-innlegging av data mellom forskjellige systemer?</li>
                    </ul>
                    
                    <button class="btn btn-primary" onclick="openInterviewPopup('enduser')">Nytt Sluttbruker Intervju</button>
                </div>
            </div>
            
            <div class="card">
                <h3>üìã Gjennomf√∏rte Intervjuer</h3>
                <div id="completed-interviews">
                    <div style="text-align: center; padding: 2rem; color: #666; font-style: italic;">
                        <p>Ingen intervjuer registrert enn√•</p>
                    <p>Start med √• gjennomf√∏re stakeholder og sluttbruker intervjuer</p>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Process Mapping Section -->
        <section id="process" class="content-section">
            <h2>üó∫Ô∏è Prosess Mapping - Ops Canvas</h2>
            <p>Kartlegg bedriftens kjerneprosesser i de tre hovedmotorene og identifiser ineffektiviteter</p>
            
            <div class="grid grid-3">
                <div class="card">
                    <h3>üéØ Akkvisisjonsmotor</h3>
                    <p><em>Hvordan finner og signerer dere nye kunder?</em></p>
                    <div id="acquisition-processes" style="margin: 1rem 0;">
                        <div style="text-align: center; padding: 1rem; color: #666; font-style: italic;">
                            Ingen prosesser kartlagt enn√•
                    </div>
                    </div>
                    <button class="btn btn-success" onclick="addProcess('acquisition')">+ Legg til prosess</button>
                </div>
                
                <div class="card">
                    <h3>üîß Leveransemotor</h3>
                    <p><em>Hvordan leverer dere produktet eller tjenesten?</em></p>
                    <div id="delivery-processes" style="margin: 1rem 0;">
                        <div style="text-align: center; padding: 1rem; color: #666; font-style: italic;">
                            Ingen prosesser kartlagt enn√•
                    </div>
                    </div>
                    <button class="btn btn-warning" onclick="addProcess('delivery')">+ Legg til prosess</button>
                </div>
                
                <div class="card">
                    <h3>üõü St√∏ttemotor</h3>
                    <p><em>Hvordan h√•ndterer dere kundesupport og oppf√∏lging?</em></p>
                    <div id="support-processes" style="margin: 1rem 0;">
                        <div style="text-align: center; padding: 1rem; color: #666; font-style: italic;">
                            Ingen prosesser kartlagt enn√•
                    </div>
                </div>
                    <button class="btn btn-primary" onclick="addProcess('support')">+ Legg til prosess</button>
            </div>
            </div>
        </section>
        
        <!-- Opportunity Matrix Section -->
        <section id="matrix" class="content-section">
            <h2>üìä AI Mulighetsmatrise</h2>
            <p>Prioriter AI-muligheter basert p√• forretningsimpact vs implementeringsinnsats</p>
            
            <div class="grid grid-2" style="margin-bottom: 2rem;">
                <div class="card">
                    <h3>üéØ Popul√¶re AI-l√∏sninger</h3>
                    <p>Dra og slipp disse inn i matrisen:</p>
                    <div class="popular-solutions">
                        <div class="solution-chip" draggable="true" data-impact="8" data-effort="3" data-cost="150000" data-savings="300000">
                            üìß E-post Klassifisering
                        </div>
                        <div class="solution-chip" draggable="true" data-impact="7" data-effort="4" data-cost="200000" data-savings="450000">
                            ü§ñ Kundeservice Chatbot
                        </div>
                        <div class="solution-chip" draggable="true" data-impact="9" data-effort="6" data-cost="400000" data-savings="800000">
                            üìä Prediktiv Analyse
                        </div>
                        <div class="solution-chip" draggable="true" data-impact="6" data-effort="2" data-cost="75000" data-savings="200000">
                            üìÑ Dokument Automatisering
                        </div>
                        <div class="solution-chip" draggable="true" data-impact="8" data-effort="5" data-cost="300000" data-savings="600000">
                            üîç Intelligente S√∏k
                        </div>
                        <div class="solution-chip" draggable="true" data-impact="7" data-effort="3" data-cost="120000" data-savings="350000">
                            üìÖ M√∏teplanlegging AI
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <h3>‚ûï Lag egendefinert l√∏sning</h3>
                    <div style="margin-bottom: 1rem;">
                        <label>L√∏sningsnavn:</label>
                        <input type="text" id="custom-solution-name" class="form-input" placeholder="Min AI-l√∏sning">
                    </div>
                    <div class="grid grid-2">
                        <div>
                            <label>Forretningsimpact (1-10):</label>
                            <input type="range" id="custom-impact" min="1" max="10" value="5" class="form-range">
                            <span id="impact-value">5</span>
                        </div>
                        <div>
                            <label>Implementeringsinnsats (1-10):</label>
                            <input type="range" id="custom-effort" min="1" max="10" value="5" class="form-range">
                            <span id="effort-value">5</span>
                        </div>
                    </div>
                    <div class="grid grid-2">
                        <div>
                            <label>Estimert kostnad (NOK):</label>
                            <input type="number" id="custom-cost" class="form-input" placeholder="200000" min="0">
                        </div>
                        <div>
                            <label>√Örlig besparelse (NOK):</label>
                            <input type="number" id="custom-savings" class="form-input" placeholder="400000" min="0">
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="addCustomOpportunity()">‚ûï Legg til i matrise</button>
                </div>
            </div>
            
            <div class="matrix-container">
                <!-- Axis labels -->
                <div class="matrix-label" style="top: -30px; left: 50%; transform: translateX(-50%);">H√òY IMPACT</div>
                <div class="matrix-label" style="bottom: -30px; left: 50%; transform: translateX(-50%);">LAV IMPACT</div>
                <div class="matrix-label" style="left: -80px; top: 50%; transform: translateY(-50%) rotate(-90deg);">LAV INNSATS</div>
                <div class="matrix-label" style="right: -80px; top: 50%; transform: translateY(-50%) rotate(90deg);">H√òY INNSATS</div>
                
                <!-- Quadrant labels -->
                <div class="matrix-quadrant" style="top: 10px; left: 10px; background: rgba(76, 175, 80, 0.9);">
                    üåü HURTIGE GEVINSTER
                </div>
                <div class="matrix-quadrant" style="top: 10px; right: 10px; background: rgba(33, 150, 243, 0.9);">
                    üöÄ STORE SATSINGER
                </div>
                <div class="matrix-quadrant" style="bottom: 10px; left: 10px; background: rgba(255, 152, 0, 0.9);">
                    üëç NICE-TO-HAVE
                </div>
                <div class="matrix-quadrant" style="bottom: 10px; right: 10px; background: rgba(244, 67, 54, 0.9);">
                    üö´ DEPRIORIT√âR
                </div>
                
                <!-- Center lines -->
                <div style="position: absolute; top: 50%; left: 0; right: 0; height: 1px; background: #666; opacity: 0.3;"></div>
                <div style="position: absolute; left: 50%; top: 0; bottom: 0; width: 1px; background: #666; opacity: 0.3;"></div>
            </div>
        </section>
        
        <!-- ROI Calculator Section -->
        <section id="roi" class="content-section">
            <h2>üí∞ ROI Kalkulator - "Money Slide"</h2>
            <p>Beregn finansiell avkastning p√• AI-investeringer med automatiske kalkulasjoner</p>
            
            <div class="grid grid-4">
                <div class="stat-card" style="background: linear-gradient(135deg, #1976d2, #1565c0);">
                    <div>Total Investering</div>
                    <div class="stat-value" id="total-investment">0</div>
                    <small>NOK</small>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #4caf50, #388e3c);">
                    <div>√Örlig Besparelse</div>
                    <div class="stat-value" id="annual-savings">0</div>
                    <small>NOK</small>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #ff9800, #f57c00);">
                    <div>ROI</div>
                    <div class="stat-value" id="roi-percentage">0%</div>
                    <small>Avkastning</small>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #e91e63, #c2185b);">
                    <div>Payback</div>
                    <div class="stat-value" id="payback-period">0</div>
                    <small>m√•neder</small>
                </div>
            </div>
            
            <div class="card">
                <h3>üìä Legg til ROI Beregning</h3>
                <div class="grid grid-2">
                    <div>
                        <h4>üíº Investering</h4>
                        <div style="margin-bottom: 1rem;">
                            <label>Utviklingskostnad (NOK):</label>
                            <input type="number" id="development-cost" class="form-input" placeholder="150000" min="0">
                </div>
                        <div style="margin-bottom: 1rem;">
                            <label>Implementeringskostnad (NOK):</label>
                            <input type="number" id="implementation-cost" class="form-input" placeholder="50000" min="0">
                        </div>
                        <div style="margin-bottom: 1rem;">
                            <label>√Örlig driftskostnad (NOK):</label>
                            <input type="number" id="annual-operation-cost" class="form-input" placeholder="25000" min="0">
                        </div>
                    </div>
                    <div>
                        <h4>üí∞ Besparelser</h4>
                        <div style="margin-bottom: 1rem;">
                            <label>Timer spart per uke:</label>
                            <input type="number" id="hours-saved" class="form-input" placeholder="10" min="0" step="0.5">
                        </div>
                        <div style="margin-bottom: 1rem;">
                            <label>Gjennomsnittlig timel√∏nn (NOK):</label>
                            <input type="number" id="hourly-rate" class="form-input" placeholder="600" min="0">
                        </div>
                        <div style="margin-bottom: 1rem;">
                            <label>Ekstra √•rlig inntekt (NOK):</label>
                            <input type="number" id="additional-revenue" class="form-input" placeholder="0" min="0">
                        </div>
                </div>
                </div>
                <button class="btn btn-primary" onclick="calculateROI()">üßÆ Beregn ROI</button>
                <button class="btn btn-success" onclick="addToOpportunityMatrix()">‚ûï Legg til i Mulighetsmatrise</button>
            </div>
            
            <div class="card" id="roi-results" style="display: none;">
                <h3>üìä Detaljert ROI Analyse</h3>
            <div class="grid grid-2">
                    <div>
                        <h4>üí∏ Kostnader (3 √•r)</h4>
                        <ul id="cost-breakdown">
                            <!-- Populated by JavaScript -->
                    </ul>
                </div>
                    <div>
                        <h4>üí∞ Besparelser (3 √•r)</h4>
                        <ul id="savings-breakdown">
                            <!-- Populated by JavaScript -->
                    </ul>
                </div>
            </div>
                <div class="alert alert-success">
                    <h4>üéØ Anbefaling:</h4>
                    <p id="roi-recommendation">
                        <!-- Populated by JavaScript -->
                    </p>
                </div>
            </div>
        </section>
        
        <!-- Presentation Section -->
        <section id="presentation" class="content-section">
            <h2>üìë Presentasjonsgenerator</h2>
            <p>Automatisk sammenstilling av alle funn til profesjonell klientpresentasjon</p>
            
            <div style="margin-bottom: 2rem;">
                <button class="btn btn-success">üìÑ Eksporter til PDF</button>
                <button class="btn btn-primary">üñ®Ô∏è Skriv ut</button>
                <button class="btn btn-warning">üìß Send til klient</button>
            </div>
            
            <div class="card">
                <h3>AI Revisjon Presentasjon - 6 N√∏kkelslides</h3>
                <p>Komplett presentasjon genereres automatisk basert p√• alle innsamlede data.</p>
            </div>
        </section>
    </main>
    
    <!-- Interview Popup Modal -->
    <div id="interview-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Nytt Intervju</h3>
                <span class="close" onclick="closeInterviewPopup()">&times;</span>
                        </div>
            <div class="modal-body">
                <form id="interview-form">
                    <div style="margin-bottom: 1rem;">
                        <label style="font-weight: bold;">Navn p√• intervjuobjekt:</label>
                        <input type="text" id="interviewee-name" class="form-input" placeholder="Ola Nordmann">
                        </div>
                    <div style="margin-bottom: 1rem;">
                        <label style="font-weight: bold;">Stilling/Rolle:</label>
                        <input type="text" id="interviewee-role" class="form-input" placeholder="Daglig leder">
                        </div>
                    <div id="interview-questions">
                        <!-- Questions will be populated by JavaScript -->
                        </div>
                    <div style="margin-top: 2rem;">
                        <button type="button" class="btn btn-primary" onclick="saveInterview()">üíæ Lagre Intervju</button>
                        <button type="button" class="btn btn-secondary" onclick="closeInterviewPopup()">Avbryt</button>
                    </div>
                </form>
                </div>
                    </div>
                </div>
                
    <!-- New Project Popup Modal -->
    <div id="project-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üìã Nytt AI Revisjon Prosjekt</h3>
                <span class="close" onclick="closeProjectPopup()">&times;</span>
                        </div>
            <div class="modal-body">
                <form id="project-form">
                    <div style="margin-bottom: 1rem;">
                        <label style="font-weight: bold;">Bedriftsnavn:</label>
                        <input type="text" id="company-name" class="form-input" placeholder="Bedrift AS" required>
                        </div>
                    <div style="margin-bottom: 1rem;">
                        <label style="font-weight: bold;">Bransje:</label>
                        <select id="industry" class="form-input" required>
                            <option value="">Velg bransje</option>
                            <option value="teknologi">Teknologi</option>
                            <option value="finans">Finans</option>
                            <option value="helse">Helse</option>
                            <option value="utdanning">Utdanning</option>
                            <option value="eiendom">Eiendom</option>
                            <option value="handel">Handel</option>
                            <option value="produksjon">Produksjon</option>
                            <option value="tjenester">Tjenester</option>
                            <option value="annet">Annet</option>
                        </select>
                        </div>
                    <div class="grid grid-2">
                        <div>
                            <label style="font-weight: bold;">Antall ansatte:</label>
                            <select id="company-size" class="form-input" required>
                                <option value="">Velg st√∏rrelse</option>
                                <option value="1-10">1-10 ansatte</option>
                                <option value="11-50">11-50 ansatte</option>
                                <option value="51-200">51-200 ansatte</option>
                                <option value="201-1000">201-1000 ansatte</option>
                                <option value="1000+">1000+ ansatte</option>
                            </select>
                    </div>
                        <div>
                            <label style="font-weight: bold;">√Örlig omsetning (NOK):</label>
                            <select id="revenue" class="form-input">
                                <option value="">Velg omsetning</option>
                                <option value="0-5m">0-5 millioner</option>
                                <option value="5-25m">5-25 millioner</option>
                                <option value="25-100m">25-100 millioner</option>
                                <option value="100-500m">100-500 millioner</option>
                                <option value="500m+">500+ millioner</option>
                            </select>
                </div>
                </div>
                    <div style="margin-bottom: 1rem;">
                        <label style="font-weight: bold;">Kontaktperson:</label>
                        <input type="text" id="contact-person" class="form-input" placeholder="Ola Nordmann">
                    </div>
                    <div style="margin-bottom: 1rem;">
                        <label style="font-weight: bold;">E-post:</label>
                        <input type="email" id="contact-email" class="form-input" placeholder="ola@bedrift.no">
                </div>
                    <div style="margin-bottom: 1rem;">
                        <label style="font-weight: bold;">Hovedutfordringer (valgfritt):</label>
                        <textarea id="main-challenges" class="form-input" rows="3" placeholder="Beskriv de st√∏rste utfordringene bedriften st√•r overfor..."></textarea>
                    </div>
                    <div style="margin-top: 2rem;">
                        <button type="button" class="btn btn-primary" onclick="saveNewProject()">üöÄ Opprett Prosjekt</button>
                        <button type="button" class="btn btn-secondary" onclick="closeProjectPopup()">Avbryt</button>
                </div>
                </form>
                </div>
            </div>
            </div>
                
    <!-- Google Fonts for AIKI theme -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Roboto:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- JavaScript files -->
    <script src="js/aiki-common.js"></script>
    <script src="js/main.js"></script>
    <script src="js/components.js"></script>
    
    <script>
        // Global variables for project management
        let currentProject = 'demo';
        let projects = {
            'demo': {
                name: 'Demo Bedrift AS',
                industry: 'teknologi',
                size: '51-200',
                contact: 'Demo Kontakt',
                email: 'demo@bedrift.no',
                created: '2024-01-15',
                interviews: [],
                opportunities: [],
                processes: [],
                progress: 15
            }
        };
        
        // Project management functions
        function selectProject(projectId) {
            currentProject = projectId;
            
            // Update active project in list
            document.querySelectorAll('.project-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-project="${projectId}"]`).classList.add('active');
            
            // Update dashboard display
            updateDashboard();
        }
        
        function updateDashboard() {
            const project = projects[currentProject];
            if (!project) return;
            
            document.getElementById('current-project-name').textContent = project.name;
            document.getElementById('project-name-roi').textContent = project.name;
            document.getElementById('interviews-count').textContent = project.interviews.length;
            document.getElementById('opportunities-count').textContent = project.opportunities.length;
            document.getElementById('project-progress').style.width = project.progress + '%';
            document.getElementById('progress-text').textContent = `Prosjektfremgang: ${project.progress}%`;
        }
        
        function openNewProjectPopup() {
            document.getElementById('project-modal').style.display = 'block';
        }
        
        function closeProjectPopup() {
            document.getElementById('project-modal').style.display = 'none';
            document.getElementById('project-form').reset();
        }
        
        function saveNewProject() {
            const companyName = document.getElementById('company-name').value;
            const industry = document.getElementById('industry').value;
            const companySize = document.getElementById('company-size').value;
            const revenue = document.getElementById('revenue').value;
            const contactPerson = document.getElementById('contact-person').value;
            const contactEmail = document.getElementById('contact-email').value;
            const mainChallenges = document.getElementById('main-challenges').value;
            
            if (!companyName || !industry || !companySize) {
                alert('Vennligst fyll ut alle obligatoriske felt (bedriftsnavn, bransje, antall ansatte).');
                return;
            }
            
            // Generate project ID
            const projectId = companyName.toLowerCase().replace(/[^a-z0-9]/g, '');
            
            // Create new project
            projects[projectId] = {
                name: companyName,
                industry: industry,
                size: companySize,
                revenue: revenue,
                contact: contactPerson,
                email: contactEmail,
                challenges: mainChallenges,
                created: new Date().toISOString().split('T')[0],
                interviews: [],
                opportunities: [],
                processes: [],
                progress: 0
            };
            
            // Add to project list
            const projectList = document.getElementById('project-list');
            const newProjectItem = document.createElement('div');
            newProjectItem.className = 'project-item';
            newProjectItem.setAttribute('data-project', projectId);
            newProjectItem.onclick = () => selectProject(projectId);
            newProjectItem.innerHTML = `
                <div class="project-header">
                    <strong>üè¢ ${companyName}</strong>
                    <span class="badge badge-info">Nytt</span>
                </div>
                <small>Startet: ${new Date().toLocaleDateString('no-NO')}</small>
            `;
            
            projectList.appendChild(newProjectItem);
            
            // Select the new project
            selectProject(projectId);
            
            alert(`Prosjekt "${companyName}" opprettet! üéâ`);
            closeProjectPopup();
        }
        
        // Interview popup functionality
        function openInterviewPopup(type) {
            const modal = document.getElementById('interview-modal');
            const title = document.getElementById('modal-title');
            const questionsContainer = document.getElementById('interview-questions');
            
            title.textContent = type === 'stakeholder' ? 'Nytt Stakeholder Intervju' : 'Nytt Sluttbruker Intervju';
            
            const questions = type === 'stakeholder' ? [
                'Kan du beskrive din rolle og teamets hovedansvar?',
                'Hva er de viktigste m√•lene eller KPI-ene teamet ditt er ansvarlig for?',
                'Hvor ser du de st√∏rste flaskehalser eller forsinkelser i arbeidsflyt?',
                'Hva er de st√∏rste frustrasjonene med n√•v√¶rende teknologistakk?',
                'Hvis du hadde en tryllestav, hvilket problem ville du l√∏st over natten?'
            ] : [
                'Kan du ta meg gjennom en typisk arbeidsdag eller -uke?',
                'Hva er de mest manuelle og repetitive delene av jobben din?',
                'Hvilken del av prosessen tar mest tid eller er mest frustrerende?',
                'Hvis du hadde en assistent, hvilke oppgaver ville du gitt dem f√∏rst?',
                'Er det dobbel-innlegging av data mellom forskjellige systemer?'
            ];
            
            questionsContainer.innerHTML = questions.map((q, i) => `
                <div class="question-group" style="margin-bottom: 1.5rem;">
                    <label style="font-weight: bold; display: block; margin-bottom: 0.5rem;">${i + 1}. ${q}</label>
                    <textarea class="form-input" rows="3" placeholder="Skriv svaret her..."></textarea>
                </div>
            `).join('');
            
            // Store interview type
            modal.setAttribute('data-interview-type', type);
            modal.style.display = 'block';
        }
        
        function closeInterviewPopup() {
            document.getElementById('interview-modal').style.display = 'none';
            document.getElementById('interview-form').reset();
        }
        
        function saveInterview() {
            const name = document.getElementById('interviewee-name').value;
            const role = document.getElementById('interviewee-role').value;
            const textareas = document.querySelectorAll('#interview-questions textarea');
            const answers = Array.from(textareas).map(ta => ta.value);
            const type = document.getElementById('interview-modal').getAttribute('data-interview-type');
            
            if (!name || !role) {
                alert('Vennligst fyll ut navn og rolle p√• intervjuobjektet.');
                return;
            }
            
            if (!answers.some(answer => answer.trim())) {
                alert('Vennligst fyll ut minst ett sp√∏rsm√•l.');
                return;
            }
            
            // Save interview to current project
            const interview = {
                name: name,
                role: role,
                type: type,
                answers: answers,
                date: new Date().toISOString().split('T')[0]
            };
            
            projects[currentProject].interviews.push(interview);
            
            // Update progress
            projects[currentProject].progress = Math.min(projects[currentProject].progress + 10, 100);
            
            // Update dashboard
            updateDashboard();
            
            // Update interview list
            updateInterviewList();
            
            alert(`Intervju med ${name} lagret! ‚úÖ`);
            closeInterviewPopup();
        }
        
        // Process management functions
        function addProcess(engine) {
            const processName = prompt(`Navn p√• prosess i ${engine === 'acquisition' ? 'Akkvisisjonsmotor' : engine === 'delivery' ? 'Leveransemotor' : 'St√∏ttemotor'}:`);
            if (!processName) return;
            
            const isTimeSink = confirm('Er dette en tidssink? (manuell, repetitiv prosess)');
            const isQualityRisk = confirm('Er dette en kvalitetsrisiko? (utsatt for menneskelige feil)');
            
            const process = {
                name: processName,
                engine: engine,
                timeSink: isTimeSink,
                qualityRisk: isQualityRisk,
                date: new Date().toISOString().split('T')[0]
            };
            
            projects[currentProject].processes.push(process);
            projects[currentProject].progress = Math.min(projects[currentProject].progress + 5, 100);
            
            updateDashboard();
            updateProcessDisplay();
            
            alert(`Prosess "${processName}" lagt til! üìù`);
        }
        
        function updateProcessDisplay() {
            const project = projects[currentProject];
            if (!project) return;
            
            const acquisitionContainer = document.getElementById('acquisition-processes');
            const deliveryContainer = document.getElementById('delivery-processes');
            const supportContainer = document.getElementById('support-processes');
            
            // Clear containers
            [acquisitionContainer, deliveryContainer, supportContainer].forEach(container => {
                container.innerHTML = '<div style="text-align: center; padding: 1rem; color: #666; font-style: italic;">Ingen prosesser kartlagt enn√•</div>';
            });
            
            // Add processes
            project.processes.forEach(process => {
                const processElement = document.createElement('div');
                processElement.className = 'process-item';
                processElement.style.cssText = 'padding: 0.5rem; margin: 0.25rem 0; background: #f8f9fa; border-radius: 6px; border-left: 4px solid #ddd;';
                
                if (process.timeSink) {
                    processElement.style.borderLeftColor = '#ff9800';
                    processElement.style.background = '#fff3cd';
                }
                if (process.qualityRisk) {
                    processElement.style.borderLeftColor = '#f44336';
                    processElement.style.background = '#ffebee';
                }
                
                processElement.innerHTML = `
                    <div style="font-weight: bold;">${process.name}</div>
                    <small>${process.timeSink ? '‚è±Ô∏è Tidssink' : ''} ${process.qualityRisk ? '‚ö†Ô∏è Kvalitetsrisiko' : ''}</small>
                `;
                
                const container = process.engine === 'acquisition' ? acquisitionContainer : 
                                process.engine === 'delivery' ? deliveryContainer : supportContainer;
                
                if (container.children[0].textContent.includes('Ingen prosesser')) {
                    container.innerHTML = '';
                }
                container.appendChild(processElement);
            });
        }
        
        function updateInterviewList() {
            const project = projects[currentProject];
            if (!project) return;
            
            const container = document.getElementById('completed-interviews');
            
            if (project.interviews.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: #666; font-style: italic;">
                        <p>Ingen intervjuer registrert enn√•</p>
                        <p>Start med √• gjennomf√∏re stakeholder og sluttbruker intervjuer</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = project.interviews.map(interview => `
                <div class="interview-item" style="background: #f8f9fa; padding: 1rem; margin: 0.5rem 0; border-radius: 8px; border-left: 4px solid ${interview.type === 'stakeholder' ? '#2196f3' : '#4caf50'};">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong>${interview.name}</strong> - ${interview.role}
                            <br><small>${interview.type === 'stakeholder' ? 'üë• Stakeholder' : 'üë§ Sluttbruker'} ‚Ä¢ ${new Date(interview.date).toLocaleDateString('no-NO')}</small>
                        </div>
                        <span class="badge ${interview.type === 'stakeholder' ? 'badge-info' : 'badge-success'}">
                            ${interview.answers.filter(a => a.trim()).length} svar
                        </span>
                    </div>
                </div>
            `).join('');
        }
        
        // Make functions and variables globally available
        window.currentProject = currentProject;
        window.projects = projects;
        window.selectProject = selectProject;
        window.updateDashboard = updateDashboard;
        window.openNewProjectPopup = openNewProjectPopup;
        window.closeProjectPopup = closeProjectPopup;
        window.saveNewProject = saveNewProject;
        window.openInterviewPopup = openInterviewPopup;
        window.closeInterviewPopup = closeInterviewPopup;
        window.saveInterview = saveInterview;
        window.addProcess = addProcess;
        window.updateProcessDisplay = updateProcessDisplay;
        window.updateInterviewList = updateInterviewList;
        
        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize dashboard
            updateDashboard();
            updateInterviewList();
            updateProcessDisplay();
            
            // Initialize drag and drop if function exists
            if (window.initializeDragAndDrop) {
                setTimeout(window.initializeDragAndDrop, 100);
            }
        });
        
        // Close modals when clicking outside
        window.onclick = function(event) {
            const interviewModal = document.getElementById('interview-modal');
            const projectModal = document.getElementById('project-modal');
            
            if (event.target === interviewModal) {
                closeInterviewPopup();
            }
            if (event.target === projectModal) {
                closeProjectPopup();
            }
        }
    </script>
    
    <style>
        /* Modal Styles */
        .modal {
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 0;
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
        
        .modal-header {
            padding: 1.5rem 2rem;
            background: linear-gradient(135deg, #1976d2, #1565c0);
            color: white;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h3 {
            margin: 0;
        }
        
        .close {
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            opacity: 0.7;
        }
        
        .close:hover {
            opacity: 1;
        }
        
        .modal-body {
            padding: 2rem;
        }
        
        .question-group textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
    </style>
</body>
</html>